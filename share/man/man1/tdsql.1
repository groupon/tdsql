.\" Automatically generated by Pod::Man 2.23 (Pod::Simple 3.14)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  \*(C+ will
.\" give a nicer C++.  Capital omega is used to do unbreakable dashes and
.\" therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
.\" nothing in troff, for use with C<>.
.tr \(*W-
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is turned on, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.ie \nF \{\
.    de IX
.    tm Index:\\$1\t\\n%\t"\\$2"
..
.    nr % 0
.    rr F
.\}
.el \{\
.    de IX
..
.\}
.\"
.\" Accent mark definitions (@(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2).
.\" Fear.  Run.  Save yourself.  No user-serviceable parts.
.    \" fudge factors for nroff and troff
.if n \{\
.    ds #H 0
.    ds #V .8m
.    ds #F .3m
.    ds #[ \f1
.    ds #] \fP
.\}
.if t \{\
.    ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.    ds #V .6m
.    ds #F 0
.    ds #[ \&
.    ds #] \&
.\}
.    \" simple accents for nroff and troff
.if n \{\
.    ds ' \&
.    ds ` \&
.    ds ^ \&
.    ds , \&
.    ds ~ ~
.    ds /
.\}
.if t \{\
.    ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.    ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.    ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.    ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.    ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.    ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.\}
.    \" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.    \" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.    \" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.    ds : e
.    ds 8 ss
.    ds o a
.    ds d- d\h'-1'\(ga
.    ds D- D\h'-1'\(hy
.    ds th \o'bp'
.    ds Th \o'LP'
.    ds ae ae
.    ds Ae AE
.\}
.rm #[ #] #H #V #F C
.\" ========================================================================
.\"
.IX Title "TDSQL 1"
.TH TDSQL 1 "2012-11-30" "perl v5.12.3" "User Contributed Perl Documentation"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH "NAME"
tdsql \- run SQL queries against a Teradata data warehouse server
.SH "SYNOPSIS"
.IX Header "SYNOPSIS"
.Vb 1
\&  % tdsql [\-h] [\-H host] [\-u user] [\-p pass] [\-o file] [\-f format] [\-r] [sql] [args]
.Ve
.SH "DESCRIPTION"
.IX Header "DESCRIPTION"
Teradata ships with very little Unix command line support other than the
\&\s-1BTEQ\s0 tool. In particular, it lacks an interactive command prompt tool
(like mysql for MySQL, psql for PostgreSQL, or vsql for Vertica). The
tdsql program aims to fill that gap.
.PP
This program runs an \s-1SQL\s0 query against the Teradata data warehouse, and
then sends the output of the query either to stdout, or to an output
file. The \s-1SQL\s0 can be provided on the command line, to stdin, or
interactively via a command prompt that supports readline command line
editing. Database credentials can be provided on the command line, or in
the initialization file \fI~/.tdsqlrc\fR.
.SS "Command-Line Options"
.IX Subsection "Command-Line Options"
The following optional command-line arguments are accepted:
.ie n .IP """\-h"", ""\-\-help""" 4
.el .IP "\f(CW\-h\fR, \f(CW\-\-help\fR" 4
.IX Item "-h, --help"
Display command line help and exit.
.ie n .IP """\-H"" \fIhost\fR, ""\-\-hostname=""\fIhost\fR" 4
.el .IP "\f(CW\-H\fR \fIhost\fR, \f(CW\-\-hostname=\fR\fIhost\fR" 4
.IX Item "-H host, --hostname=host"
Connect to this hostname (default localhost).
.ie n .IP """\-u"" \fIuser\fR, ""\-\-username=""\fIuser\fR" 4
.el .IP "\f(CW\-u\fR \fIuser\fR, \f(CW\-\-username=\fR\fIuser\fR" 4
.IX Item "-u user, --username=user"
Connect with this username (default your Unix username).
.ie n .IP """\-p"" \fIpass\fR, ""\-\-password=""\fIpass\fR" 4
.el .IP "\f(CW\-p\fR \fIpass\fR, \f(CW\-\-password=\fR\fIpass\fR" 4
.IX Item "-p pass, --password=pass"
Connect with this password (default is to prompt interactively for one).
.ie n .IP """\-o"" \fIfile\fR, ""\-\-output=""\fIfile\fR" 4
.el .IP "\f(CW\-o\fR \fIfile\fR, \f(CW\-\-output=\fR\fIfile\fR" 4
.IX Item "-o file, --output=file"
Write output to this file (default is to write to stdout).
.ie n .IP """\-f"" \fIformat\fR, ""\-\-format=""\fIformat\fR" 4
.el .IP "\f(CW\-f\fR \fIformat\fR, \f(CW\-\-format=\fR\fIformat\fR" 4
.IX Item "-f format, --format=format"
Write output in \f(CW\*(C`text\*(C'\fR (tab-separated, the default), \f(CW\*(C`csv\*(C'\fR
(comma-separated), \f(CW\*(C`box\*(C'\fR pretty-printed boxed format (this is the
slowest output format, as all output must be buffered before any output
is printed), or \f(CW\*(C`vertical\*(C'\fR for vertical rows (like MySQL with \eG).
.ie n .IP """\-r"", ""\-\-header""" 4
.el .IP "\f(CW\-r\fR, \f(CW\-\-header\fR" 4
.IX Item "-r, --header"
Include a header row with text or csv output. If a format other than
text or csv is specified, the header argument is ignored.
.PP
The last optional command line arguments are the \s-1SQL\s0 to run, as a single
string; and any arguments to pass to the \s-1SQL\s0, if the \s-1SQL\s0 contains
question mark (\f(CW\*(C`?\*(C'\fR) positional placeholders. The default is to prompt
for \s-1SQL\s0 interactively using a command line prompt, if stdin is a tty, or
read stdin as verbatim \s-1SQL\s0, if stdin is not a tty.
.SS "Initialization File"
.IX Subsection "Initialization File"
This script looks for a file \f(CW\*(C`~/.tdsqlrc\*(C'\fR which is a file in \s-1YAML\s0 format
that has the following structure (all contents optional):
.PP
.Vb 3
\&  hostname: I<host>
\&  username: I<user>
\&  password: I<pass>
.Ve
.PP
If the file is present, then any provided values are used as the default
values for hostname, username, and password. This means you can avoid
needing to continually repeat these from the command line. Note that if
you record your password here, you should make sure the file has safe
permissions (\f(CW\*(C`chmod 600 ~/.tdsqlrc\*(C'\fR).
.SH "INSTALLATION"
.IX Header "INSTALLATION"
You can install this software simply by moving the \fIbin/tdsql\fR program
into your \s-1PATH\s0 (for example, in \fI/usr/local/bin\fR), and the man page in
\&\fIshare/man/man1/tdsql.1\fR into your \s-1MANPATH\s0 (for example, in
\&\fI/usr/local/share/man/man1\fR).
.PP
This software requires Perl (it is tested with Perl 5.12.3), and the
following \s-1CPAN\s0 modules:
.IP "\(bu" 4
\&\s-1DBI\s0
.IP "\(bu" 4
Term::ReadKey
.IP "\(bu" 4
Term::ReadLine::Gnu
.IP "\(bu" 4
Text::CSV_XS
.PP
It also relies on the DBD::Teradata module available here:
<http://www.presicient.com/tdatdbd/>
.PP
That module in turn has these dependencies:
.IP "\(bu" 4
Crypt:ECB
.IP "\(bu" 4
Crypt::Rijndael
.IP "\(bu" 4
Digest::SHA1
.SH "EXAMPLES"
.IX Header "EXAMPLES"
.Vb 1
\&  % tdsql \-H td \-u johndoe
\&
\&  % echo \*(AqSELECT col1, col2 FROM db1.table1\*(Aq | tdsql \-H td \-u johndoe
\&
\&  % tdsql \-o output.txt \*(AqSELECT col1, col2 FROM db1.table1\*(Aq
\&
\&  % tdsql \-f box \*(AqSELECT col1, col2 FROM db1.table1 WHERE col1 = ?\*(Aq \*(Aqval1\*(Aq
.Ve
.SH "TODO"
.IX Header "TODO"
.IP "\(bu" 4
Box format should not need to buffer all rows before starting display.
.IP "\(bu" 4
Recover from database connection timeouts.
.IP "\(bu" 4
Basic interaction should still work even without Term::ReadLine::Gnu.
.IP "\(bu" 4
Fall back to using stty if Term::ReadKey is not installed.
.SH "AUTHOR"
.IX Header "AUTHOR"
Andrew Ho <\fIho@groupon.com\fR>
.SH "SEE ALSO"
.IX Header "SEE ALSO"
<https://github.com/groupon/tdsql>
.SH "LICENSE"
.IX Header "LICENSE"
.Vb 2
\&  Copyright (c) 2012, Groupon, Inc.
\&  All rights reserved.
\&
\&  Redistribution and use in source and binary forms, with or without
\&  modification, are permitted provided that the following conditions are
\&  met:
\&
\&  Redistributions of source code must retain the above copyright notice,
\&  this list of conditions and the following disclaimer.
\&
\&  Redistributions in binary form must reproduce the above copyright
\&  notice, this list of conditions and the following disclaimer in the
\&  documentation and/or other materials provided with the distribution.
\&
\&  Neither the name of GROUPON nor the names of its contributors may be
\&  used to endorse or promote products derived from this software without
\&  specific prior written permission.
\&
\&  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
\&  "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
\&  LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
\&  A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
\&  HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
\&  SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
\&  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
\&  DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
\&  THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
\&  (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
\&  OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
.Ve
